{
  "version": 3,
  "sources": ["../../three/examples/jsm/controls/DragControls.js"],
  "sourcesContent": ["import {\n\tEventDispatcher,\n\tMatrix4,\n\tPlane,\n\tRaycaster,\n\tVector2,\n\tVector3\n} from 'three';\n\nconst _plane = new Plane();\nconst _raycaster = new Raycaster();\n\nconst _pointer = new Vector2();\nconst _offset = new Vector3();\nconst _intersection = new Vector3();\nconst _worldPosition = new Vector3();\nconst _inverseMatrix = new Matrix4();\n\nclass DragControls extends EventDispatcher {\n\n\tconstructor( _objects, _camera, _domElement ) {\n\n\t\tsuper();\n\n\t\t_domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\tlet _selected = null, _hovered = null;\n\n\t\tconst _intersections = [];\n\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tfunction activate() {\n\n\t\t\t_domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.addEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.addEventListener( 'pointerleave', onPointerCancel );\n\n\t\t}\n\n\t\tfunction deactivate() {\n\n\t\t\t_domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.removeEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.removeEventListener( 'pointerleave', onPointerCancel );\n\n\t\t\t_domElement.style.cursor = '';\n\n\t\t}\n\n\t\tfunction dispose() {\n\n\t\t\tdeactivate();\n\n\t\t}\n\n\t\tfunction getObjects() {\n\n\t\t\treturn _objects;\n\n\t\t}\n\n\t\tfunction getRaycaster() {\n\n\t\t\treturn _raycaster;\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t_selected.position.copy( _intersection.sub( _offset ).applyMatrix4( _inverseMatrix ) );\n\n\t\t\t\t}\n\n\t\t\t\tscope.dispatchEvent( { type: 'drag', object: _selected } );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// hover support\n\n\t\t\tif ( event.pointerType === 'mouse' || event.pointerType === 'pen' ) {\n\n\t\t\t\t_intersections.length = 0;\n\n\t\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t\t_raycaster.intersectObjects( _objects, scope.recursive, _intersections );\n\n\t\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t\tconst object = _intersections[ 0 ].object;\n\n\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( object.matrixWorld ) );\n\n\t\t\t\t\tif ( _hovered !== object && _hovered !== null ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( _hovered !== object ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveron', object: object } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'pointer';\n\t\t\t\t\t\t_hovered = object;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( _hovered !== null ) {\n\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_intersections.length = 0;\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t_raycaster.intersectObjects( _objects, scope.recursive, _intersections );\n\n\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t_selected = ( scope.transformGroup === true ) ? _objects[ 0 ] : _intersections[ 0 ].object;\n\n\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t_inverseMatrix.copy( _selected.parent.matrixWorld ).invert();\n\t\t\t\t\t_offset.copy( _intersection ).sub( _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\t}\n\n\t\t\t\t_domElement.style.cursor = 'move';\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragstart', object: _selected } );\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction onPointerCancel() {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragend', object: _selected } );\n\n\t\t\t\t_selected = null;\n\n\t\t\t}\n\n\t\t\t_domElement.style.cursor = _hovered ? 'pointer' : 'auto';\n\n\t\t}\n\n\t\tfunction updatePointer( event ) {\n\n\t\t\tconst rect = _domElement.getBoundingClientRect();\n\n\t\t\t_pointer.x = ( event.clientX - rect.left ) / rect.width * 2 - 1;\n\t\t\t_pointer.y = - ( event.clientY - rect.top ) / rect.height * 2 + 1;\n\n\t\t}\n\n\t\tactivate();\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\t\tthis.recursive = true;\n\t\tthis.transformGroup = false;\n\n\t\tthis.activate = activate;\n\t\tthis.deactivate = deactivate;\n\t\tthis.dispose = dispose;\n\t\tthis.getObjects = getObjects;\n\t\tthis.getRaycaster = getRaycaster;\n\n\t}\n\n}\n\nexport { DragControls };\n"],
  "mappings": "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",
  "names": []
}
